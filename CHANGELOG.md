# Feature History

- 001-restaurant-wishlist: Migrated from Dexie.js (IndexedDB) to Supabase (Postgres + Kakao OAuth). Dropped offline/guest mode. All data is cloud-synced per user.
- 002-integrate-search-tabs: Merged Search & Map tabs into unified search+map page with bottom sheet, auto-fit bounds, marker interaction.
- 003-merge-wishlist-categories: Replaced flat wishlist with auto-categorized accordion view (grouped by Kakao subcategory). Removed By Menu tab. Improved auth callback error handling and login UX.
- 004-smart-search: Added semantic query expansion (12 food category dictionary) and distance-sorted results. Searching "chicken" now finds KFC, BBQ, etc. Results sorted nearest-first with distance labels. Uses Kakao API `sort=distance` + `radius=5000m`. Parallel queries via `Promise.allSettled` with dedup.
- 005-remove-map-tab: Removed standalone Map tab (redundant with unified search+map page). Added `/map` → `/search` permanent redirect. Cleaned up dead `searchByBounds` code.
- 006-viewport-search: Replaced fixed 5km-radius/45-result search with viewport-based search. "Search this area" button on pan/zoom, full pagination (up to 3 pages per term), 300-result cap. Error toast with retry on failure.
- 007-social-follow: Added social follow system — user search, follow/unfollow, profile pages (`/users`, `/users/[id]`), and public wishlist viewing. New DB tables: `profiles` and `follows`. `restaurants` RLS updated from per-user to all-authenticated-users.
- 008-korean-localization: Replaced all English UI strings with Korean. "Wishlist" → "맛집" throughout. No i18n framework — direct string replacement.
- 009-fix-my-tab-redirect: Fixed MY tab — `/my` route now renders own profile inline instead of redirecting to `/users/{id}`. MY tab stays highlighted.
- 010-rename-my-tab: Renamed bottom nav "MY" tab to "내정보" for consistent Korean navigation (맛집, 검색, 사람, 내정보).
- 011-restaurant-sharing: Added mutual-follower restaurant recommendation system. Users can recommend restaurants from their own wishlist to mutual followers. New `recommendations` table with RLS, two Postgres functions (`get_mutual_followers`, `get_unread_recommendation_count`). New UI: TopBar with bell-icon badge, RecommendModal, RecommendationCard, `/recommendations` inbox page.
- 013-search-add-sort: Changed search sort from distance-first to relevance-first (`sort=accuracy`). Added star rating selector when adding restaurants from map. Bottom sheet auto-collapses on marker click.
- 014-visited-wishlist: Split restaurant list into "맛집 리스트" (visited, star rating 1-3) and "위시 리스트" (wishlist, no rating). Nullable `star_rating` as discriminator (NULL = wishlist). Two-section layout on main/profile pages, dual add buttons on search (+ for wishlist, ★ for visited), ♡/★ saved indicators.
- 015-global-search: Added global search fallback — when keyword search finds fewer than 5 results within viewport, retries without geographic bounds (nationwide). Map pans/zooms to fit distant results.
- 016-profile-star-ratings: Star ratings (1-3) now visible in read-only mode on all profile pages (`/users/[id]` and `/my`). Uses existing `StarRating` component with `readonly` prop.
- 017-naver-map-import: Added Naver Map bookmark import — paste public share link, server-side fetch via undocumented Naver API, Haversine dedup (50m), bulk insert to Supabase. Background Kakao enrichment (fire-and-forget 202). Import history with batch undo. New routes: `/api/import/naver`, `/api/import/save`, `/api/import/enrich`, `/api/import/history`, `/api/import/batch/[id]`. New page: `/my/import`. 132 unit tests.
- 018-fix-mylist-user-filter: Fixed data isolation bug — 5 read hooks in `src/db/hooks.ts` (`useWishlist`, `useVisitedGrouped`, `useWishlistGrouped`, `useRestaurant`, `useIsWishlisted`) were missing `.eq("user_id", userId)` filters after feature 007 relaxed RLS SELECT policy for social profiles. Hooks now call `supabase.auth.getUser()` internally. 10 unit tests added.
